<!DOCTYPE html SYSTEM "http://www.thymeleaf.org/dtd/xhtml1-strict-thymeleaf-spring4-4.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">

	<head>
		<meta charset="UTF-8" />
		<meta name="keywords" content="简汇,商城,企业管理" />
		<meta name="description" content="简汇软件创作平台，极速上线，随需而变。" />
		<meta name="HandheldFriendly" content="True" />
		<meta name="MobileOptimized" content="320" />
		<meta name="format-detection" content="telephone=no" />
		<meta http-equiv="cleartype" content="on" />
		<meta name="referrer" content="always" />
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<link rel="shortcut icon" type="image/x-icon" href="/wshop/static/favicon.ico" />
		<title>商品详情</title>
		<link class="ui" rel="stylesheet" href="../../static/css/min.css" />
		<link class="ui" rel="stylesheet" href="../../static/css/me.css" />
		<style type="text/css">
			.container-fluid {
				padding-left: 4px;
				padding-right: 4px;
			}
			
			.btn-group input {
				width: 34%;
				border-left: none;
			}
			
			.fa-heart {
				font-size: 20px;
			}
			
			.row {
				padding: 2px 4px;
			}
			
			.price {
				padding: 7px 0;
				color: #FF0000;
			}
			
			.nonegood {
				text-indent: 16px;
			}
			
			.panel-body button {
				margin-bottom: 8px;
			}
			
			.mbsc-ms-top,
			.mbsc-ms-bottom {
				position: static;
			}
			
			.mbsc-ios.mbsc-ms-c {
				border: none;
			}
			
			.mbsc-ms-item-i {
				height: auto;
				width:100%;
			}
			.mbsc-ms-sc{
				border-bottom:1px solid #ddd;
			}
			.sayy {
				padding-left: 10px;
			}			
			
			.md-content {
				background: #fff;
			}
			
			.item {
				color: #919191;
			}
			
			.shopcart {
				position: relative;
			}
			
			.shopcart .goodsnumber {
				padding: 3px;
				position: absolute;
				right: -10px;
				top: -17px;
				background: #FF0000;
				border-radius: 4px;
			}
			
			.footer .btn button {
				background: #21BA45;
				color: #fff;
			}
			
			.footer .btn .btn-default {
				background: none;
				color: #000;
			}
			
			.footer .btn .goodsnumber {
				color: #fff;
			}
			.u-flyer{
				position:fixed;
				left:6%;
				top:30%;
			    display:block;
			    height:80px;
			    width:80px;
			    border-radius:50%;	
			}
			#myCarousel{
				margin-right:-10px;
				margin-left:-10px;
			}
		</style>
	</head>

	<body>
		<div id="wrapper">
			<!--广告宣传-->
			<!--<div class="swiper-container">
					<div class="swiper-wrapper">
						<div class="swiper-slide" th:if="${swipe!=null}" th:each="part:${swipe.parts}">
							<a th:href="${part.href}" ><img src="/wshop/static/images/ad1.jpg" th:src="${part.imgUrl}"></a>
						</div>
					</div>
				  </div>-->
			<!--/*广告轮播图宣传*/-->
			<div class="carousel slide" id="myCarousel">
				<div class="cow carousel-inner" role="listbox">
					<a href="#" class="swiper-wrappe item active">
						<img src="../../static/images/ad1.jpg" alt="First slide" class="img-responsive">
					</a>
					<a href="#" class=" swiper-wrappe item ">
						<img src="../../static/images/ad1.jpg" alt="Second slide" class="img-responsive">
					</a>
					<a href="#" class=" swiper-wrappe item ">
						<img src="../../static/images/ad1.jpg" alt="Third slide" class="img-responsive">
					</a>
				</div>
				<!-- 轮播（Carousel）指标 -->
				<ol class="carousel-indicators">
					<li data-target="#myCarousel" data-slide-to="0" class="active"></li>
					<li data-target="#myCarousel" data-slide-to="1"></li>
					<li data-target="#myCarousel" data-slide-to="2"></li>
				</ol>
				<!--/*触屏*/-->
				<a data-slide="prev" role="button" href="#carousel-example-generic" class="left carousel-control" hidden="hidden">
					<span aria-hidden="true" class="glyphicon glyphicon-chevron-left"></span>
					<span class="sr-only">Previous</span>
				</a>
				<a data-slide="next" role="button" href="#carousel-example-generic" class="right carousel-control" hidden="hidden">
					<span aria-hidden="true" class="glyphicon glyphicon-chevron-right"></span>
					<span class="sr-only">Next</span>
				</a>
			</div>
			<div class="container-fluid info">
				<!--/*商品标题*/-->
				<h5 class="text-center" th:text="${goods.name}">商品标题</h5>
				<!--/*商品数量按钮、收藏按钮*/-->
				<div class="row">
					<div class="col-xs-2" th:if="${goods.maxBuys>0}">
						<button type="button" class="btn btn-default btn-sm ">
                	 	    <i class="fa fa-heart" th:class="${goods.collected?'col-xs-12 it red':'col-xs-12 it'}" class="ui icon button basic"></i>
                	     </button>
						<input type="hidden" id="collected" th:value="${goods.collected}" />
					</div>
					<div class="btn-group col-xs-7" th:if="${goods.maxBuys>0}">
						<!--/*减少商品*/-->
						<button type="button" class="btn btn-default" id="reduceQtyBtn">
					    	<i class="fa fa-minus" ></i>
					    </button>
						<input type="hidden" id="minBuys" th:value="${goods.minBuys}" />
						<input type="hidden" id="maxBuys" th:value="${goods.maxBuys}" />
						<!--/*商品数量*/-->
						<input type="type" class="btn btn-default" pattern="[0-9]*" id="qty" value="1" />
						<!--/*增加商品*/-->
						<button type="button" class="btn btn-default" id="addQtyBtn">
					    	<i class="fa fa-plus"></i>
					    </button>
					</div>
					<!--/*商品价格*/-->
					<div class="col-xs-3 price" th:text="${'￥'+ #numbers.formatDecimal(goods.price,1,2) }">
						￥1200
					</div>
				</div>
				<!--/*没货了*/-->
				<div class="row" th:if="${goods.maxBuys<=0}">
					<h5 class="nonegood text-danger">售罄</h5>
				</div>
				<!--/*商品规格*/-->
				<div class="panel panel-default" th:each="refSpec:${goods.refSpecs}" th:if="${!#maps.isEmpty(goods.refSpecs)}" th:remove="tag">
					<div class="panel-heading">
						<i class="fa fa-hand-o-right"></i>
						<span th:text="${refSpec.key}">颜色</span>
					</div>
					<div class="panel-body" th:each="specValue:${refSpec.value}">
						<button type="button" class="btn btn-default" name="specBtn" th:text="${specValue.valueName}" th:id="${specValue.specId + '-' + specValue.valueId}" th:attr="specId=${specValue.specId+'-'+specValue.valueId}" th:class="${goods.have && goods.specs[specValue.specId]==specValue.valueId}? ' data selected' : 'data' ">
				              白色</button>
					</div>
					<input type="hidden" id="price" th:value="${goods.price}" />
					<input type="hidden" id="catalog" th:value="${goods.catalog}" />
					<input type="hidden" id="itemId" th:value="${goods.itemId}" />
					<input type="hidden" id="style" th:value="${goods.style}" />
					<input type="hidden" id="isLogin" th:value="${isLogin}" />
				</div>

				<!--/*商品详情展示*/-->
				<div class="panel panel-default  md-cont md-selected">
					<ul class="panel-heading md-category apps  ">
						<li data-id="1" data-page="details" data-selected="true">商品详情</li>
						<li data-id="2" data-page="evaluate">商品评价</li>
					</ul>
					<ul class="panel-body md-content" data-cat="apps" data-page='1'>
						<!--/*详情*/-->
						<li class="details" th:each="img:${goods.images}">
							<img src="../../static/images/cpmiaoshu.jpg" th:src="${img}" class="img-responsive">
						</li>
						<!--/*评价*/-->
						<li class="evaluate bb" th:each="comment:${comments}" style="text-align:static;">
							<div class="row sayy text-left">
								<div class="item">
									<i class="fa fa-user-circle " th:text="${#strings.abbreviate(comment.customer.name+'***',5)}+'说:'"></i>土豪说：
								</div>
								<span class="item" th:text="${comment.comment}">我们做朋友吧!</span>
							</div>
						</li>
					</ul>
				</div>
				<!--底部-->
				<div class="footer">
					<nav class="nav-justified btn-group-justified">
						<a href="../cart.html" class="btn" th:href="@{/mshop/cart/list}">
							<button class="btn shopcart btn-default" type="button">
							<i class="fa fa-shopping-cart"></i>
	                        <span class="goodsnumber center-block" id="cartItemCount">19</span>
						</button>

						</a>
						<a href="javascript:" class="btn shopcart add-btn">
							<button class="btn" type="button" th:class="${goods.maxBuys>0 ? 'col-xs-12 item ' : 'col-xs-12 item disabled'}" id="addCartButton">加入购物车</button>
						</a>
						<a href="#" class="btn shopcart">
							<button class="btn" type="button" th:class="${goods.maxBuys>0 ? 'col-xs-12 item' : 'col-xs-12 item disabled'}" id="buyButton">立即购买</button>
						</a>
					</nav>
				</div>
			</div>
		</div>
		<!--/*脚本*/-->
		<!--  <script type="text/javascript" src="/wshop/static/js/jquery.min.js"></script>-->
		<script type="text/javascript" src="../../static/js/min.js"></script>
		<!--<script type="text/javascript" src="/wshop/static/js/swiper.min.js"></script>
  <script type="text/javascript" src="/wshop/static/js/view/goods.info.js"></script>-->

		<script type="text/javascript">
			//轮播图
			$(function() {
				$('#myCarousel').carousel({
					interval: 3000
				})
			});
			//详情，评价切换
			$(function() {
				var $currContent,
					stripeWidth,
					$conts = $('.md-cont'),
					$currMenu = $('.md-selected'),
					$currCategory = $currMenu.find('.md-category'),
					$stripe = $('<span class="md-stripe"></span>'),
					pr = $.mobiscroll.util.jsPrefix;
				/*init categories metustrip*/
				$('.md-category').mobiscroll().menustrip({
					theme: 'ios',
					type: 'tabs',
					display: 'top',
					select: 'single',
					layout: 5,
					itemWidth: 100,
					paging: true,
					onItemTap: function(event, inst) {
						$currMenu.find('.md-content').mobiscroll('navigate', $('.' + $(event.target).data('page')));
					},
					onInit: function(event, inst) {
						if(inst.totalWidth) {
							stripeWidth = inst.totalWidth / 5;
							$stripe.css('width', stripeWidth);
							$(this).append($stripe);
						}
					}

				});
				/*init content metustrip*/
				$('.md-content').mobiscroll().menustrip({
					theme: 'ios',
					display: 'inline',
					type: 'tabs',
					layout: 1,
					paging: true,
					select: 'off',
					onAnimationStart: function(event, inst) {
						$stripe.addClass('md-stripe-anim');
						if(event.destinationX != event.originX) {
							$currCategory.mobiscroll('navigate', $('.' + $(this).data('cat') + ' li').eq(-(event.destinationX / inst.contWidth)));
						}
					},
					onAnimationEnd: function(event, inst) {
						setTimeout(function() {
							$stripe.removeClass('md-stripe-anim');
						}, 350);
					},
					onMove: function(event, inst) {
						moveStripe(Math.min(400, Math.max(0, (-event.posX * 500 / inst.totalWidth))));
					}

				});
				// init content listview
				$('.md-list').mobiscroll().listview({
					theme: 'ios',
					swipe: false,
					striped: true,
					onItemTap: function() {},
					enhance: true,
				});

				function moveStripe(pos) {
					$stripe[0].style[pr + 'Transform'] = 'translate3d(' + pos + '%, 0, 0 )';
				}
			});
			//商品飞入购物车的效果，此段代码需放入在请求数据成功后的函数执行
			var $addbtn=$(".add-btn");
		    $addbtn.on("click",function(){
		     //获取此时滚动条的距离
		      var scrollTop = $(document).scrollTop();
		      cartFly(scrollTop);
		    })
		    function cartFly(scrollTop){
		        var $copyImg=$(".carousel-inner a>img").eq(0);
		        var $imgSrc= $copyImg.attr("src");
		        var $offset=$(".fa-shopping-cart").offset();
		        var $offsetTop=Math.abs($offset.top-scrollTop);
		        var $flyImg=$('<img class="u-flyer" src="'+$imgSrc+'">');
		            $("body").append($flyImg);
		            $(".u-flyer").animate({
		                left:$offset.left+10+"px",
		                top: $offsetTop+10+"px",
		                height:0,
		                width:0,
		                },
		                1800, function() {
		                $(this).remove();
		            });  
		    }
		    //触屏滑动
		    var hammer = new Hammer(document.getElementById("myCarousel"));
			hammer.on("swiperight", function() {
				$('#myCarousel').carousel('prev')
			});
			hammer.on("swipeleft", function() {
				$('#myCarousel').carousel('next');
			})
		</script>
	</body>

</html>